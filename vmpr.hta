<!DOCTYPE html>
<head>
<title>Virgin Mobile PIN Changer</title>
<meta http-equiv="x-ua-compatible" content="ie=9">
<HTA:APPLICATION 
     APPLICATIONNAME="Virgin Mobile PIN Changer"
     SCROLL="no"
     SINGLEINSTANCE="yes"
>
<style type="text/css">
div label { display: block }
div { display: inline-block; padding: 5px }
</style>
<script language="VBScript">
	Sub Window_onLoad
		window.resizeTo 400,240
	End Sub
	
    Sub RunProgram
		phone = document.getElementById("phone").value
		pin = document.getElementById("pin").value
		if (Len(phone) = 0) then
			Msgbox "Please enter your phone number (e.g. 3333333333)"
			exit sub
		end if
		if (Len(pin) = 0) then
			Msgbox "Please enter your PIN (e.g. 222222)"
			exit sub
		end if
		freq = document.getElementById("freq").value
		fuzz = document.getElementById("fuzz").value
		output = document.getElementById("output").value
		verbose = document.getElementById("verbose").checked

		command = "phantomjs.exe vmpr.js " & phone & " " & pin
		if (Len(freq)) then command = command & " --frequency=" & freq
		if (Len(fuzz)) then command = command & " --fuzz=" & fuzz
		if (Len(output)) then command = command & " --output=" & output
		if (verbose) then command = command & " --verbose"
				
        Set objShell = CreateObject("Wscript.Shell")
		'Msgbox command
        objShell.Run command
    End Sub
</script>
</head>
<body>
<form>
<div>
    <label for="phone">Phone number</label>
    <input type="text" id="phone" size="10"/>
</div>
<div>
    <label for="pin">PIN</label>
    <input type="text" id="pin" size="6"/>
</div>    

<div>    
    <label for="freq">Frequency</label>
    <input type="text" id="freq" value="180" size="6"/>
</div>
<div>
    <label>Fuzz factor</label>
    <input type="text" id="fuzz" value="10" size="3"/>
</div>
<div>
	<label for="output">Output</label>
    <input type="file" id="output"/>
</div>
<br/>
<label for="verbose">Verbose</label>
<input type="checkbox" id="verbose" value="1"/>

<br/><br/>
<input type="button" value="Run" name="run_button" onClick="RunProgram()">
</form>
</body>